<?xml version="1.0"?>
<!DOCTYPE project>

<project name="build-common">
	
	<property environment="env" />

	<!-- - - - - - - - - - - - - - - - - - 
          Static properties
         - - - - - - - - - - - - - - - - - -->
	<property name="automator.dir.libs" value="lib" />
	<property name="automator.dir.modules" value="modules" />
	<property name="automator.dir.config" value="config" />
	<property name="automator.dir.config.environment" value="${automator.dir.config}/environments" />
	<property name="automator.dir.config.system" value="${automator.dir.config}/system" />
	<property name="automator.dir.template.system" value="system" />
	
	
	<!-- - - - - - - - - - - - - - - - - - 
          Read Hostname
         - - - - - - - - - - - - - - - - - -->
	<exec executable="uname" os="Linux" failifexecutionfails="false" outputproperty="env.HOSTNAME">
		<arg value="-n" />
	</exec>

	<condition property="hostname" value="${env.HOSTNAME}">
		<os family="unix" />
	</condition>
	<condition property="hostname" value="${env.COMPUTERNAME}">
		<os family="windows" />
	</condition>

	
	<!-- - - - - - - - - - - - - - - - - - 
          Environment properties
         - - - - - - - - - - - - - - - - - -->	
	<property file="${automator.dir}/${automator.dir.config.environment}/env.${user.name}.properties" />
	<property file="${automator.dir}/${automator.dir.config.environment}/env.${hostname}.properties" />
	<property file="${automator.dir}/${automator.dir.config.environment}/env.properties" />

	
	<!-- - - - - - - - - - - - - - - - - - 
          System properties
         - - - - - - - - - - - - - - - - - -->	
	<property file="${automator.dir}/${automator.dir.config.system}/system.${user.name}.properties" />
	<property file="${automator.dir}/${automator.dir.config.system}/system.${hostname}.properties" />
	<property file="${automator.dir}/${automator.dir.config.system}/system.properties" />
	

	<!-- - - - - - - - - - - - - - - - - - 
          Define filter
         - - - - - - - - - - - - - - - - - -->	
	<filterset id="filter.env" onmissingfiltersfile="ignore">
		<filtersfile file="${automator.dir}/${automator.dir.config.environment}/env.properties" />
		<filtersfile file="${automator.dir}/${automator.dir.config.environment}/env.${hostname}.properties" />
		<filtersfile file="${automator.dir}/${automator.dir.config.environment}/env.${user.name}.properties" />
	</filterset>

	<filterset id="filter.system" onmissingfiltersfile="ignore">
		<filtersfile file="${automator.dir}/${automator.dir.config.system}/system.properties" />
		<filtersfile file="${automator.dir}/${automator.dir.config.system}/system.${hostname}.properties" />
		<filtersfile file="${automator.dir}/${automator.dir.config.system}/system.${user.name}.properties" />
	</filterset>
	
	<filterset id="filter.all">
		<filterset refid="filter.env" />
		<filterset refid="filter.system" />
	</filterset>

	
	<!-- - - - - - - - - - - - - - - - - - 
          Classpath definitions
         - - - - - - - - - - - - - - - - - -->
	<path id="libs.classpath">
		<pathelement location="${automator.dir.libs}/ant-contrib-1.0b3.jar" />
	</path>

	
	<!-- - - - - - - - - - - - - - - - - - 
          Task definitions
         - - - - - - - - - - - - - - - - - -->
	<taskdef resource="net/sf/antcontrib/antlib.xml" classpathref="libs.classpath" />
	
	
	<!-- ================================= 
          target: help              
         ================================= -->
	<target name="help" description="Prints this overview">
		<java classname="org.apache.tools.ant.Main" fork="yes" failonerror="true">
			<classpath>
				<fileset dir="${ant.home}/lib">
					<include name="**/*.jar"/>
				</fileset>
			</classpath>
			<arg line="-projecthelp"/>
		</java>
	</target>	

</project>